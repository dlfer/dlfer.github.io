<!DOCTYPE html>

<html lang="en">
 
  <head>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.64.1" />
  <meta name="theme" content="a random mix of bootstrap, lanyon-hugo and hugo-academic themes">
  <meta name="author" content="DL Ferrario">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> 
      Computing the Smith Normal Form of a matrix, and homology groups? &middot; Test  Web Page
     </title>

  
  <link rel="stylesheet" href="//www.dlfer.xyz//css/highlight.min.css">  
  <script src="//www.dlfer.xyz//js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  <link rel="stylesheet" href="//www.dlfer.xyz//css/bootstrap.min.css">
  <link rel="stylesheet" href="//www.dlfer.xyz//css/font-awesome.min.css">
  <link rel="stylesheet" href="//www.dlfer.xyz//css/academicons.min.css">
  <link rel="stylesheet" href="//www.dlfer.xyz//css/otherstyle.css">
  <link rel="stylesheet" href="//www.dlfer.xyz//css/poole.css">
  <link rel="stylesheet" href="//www.dlfer.xyz//css/syntax.css">
  <link rel="stylesheet" href="//www.dlfer.xyz//css/lanyon.css">
  
  <link rel="stylesheet" href="//www.dlfer.xyz//css/fonts.css">
  
   
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:300|Merriweather|Roboto+Mono" rel="stylesheet">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="//www.dlfer.xyz/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="//www.dlfer.xyz/assets/favicon-gears.ico">
</head>

  <body class="theme-base-0x">
    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<div class="sidebar" id="sidebar">
  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="//www.dlfer.xyz/">Home</a>
    <a class="sidebar-nav-item " href="//www.dlfer.xyz/post">All Posts</a>
    <a class="sidebar-nav-item " href="//www.dlfer.xyz/topics/">Topics</a>
    <a class="sidebar-nav-item " href="//www.dlfer.xyz/tags/">Tags</a>
    
    
      
        <a class="sidebar-nav-item " href="//www.dlfer.xyz/p/papers/">Publications</a>
      
    
      
        <a class="sidebar-nav-item " href="//www.dlfer.xyz/p/now/">About/now</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </nav>
</div>

<title>
    
      Computing the Smith Normal Form of a matrix, and homology groups? &middot; Test  Web Page
    
  </title>
    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="//www.dlfer.xyz/" title="Home">Test  Web Page</a>
     
          </h3>
        </div>
      </div>
      <div class="container content">


<div class="post">
  <h1 class="post-title">Computing the Smith Normal Form of a matrix, and homology groups?</h1>
  <span class="post-date">2016-10-27 
	  
	  (<i class="fa fa-refresh" aria-hidden="true"></i>&nbsp;2016-10-27) 
	  
  </span>
  <h2 id="a-simple-algorithm-for-computing-the-smith-normal-form-of-a-matrix-in-zz">A simple algorithm for computing the Smith Normal Form of a matrix in $\ZZ$</h2>
<p>The proof and the algorithm are the same.</p>
<p>First, a few auxiliary functions. Given a matrix $M$, the follow two functions are
self-explanatory.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">dims</span>(M):
 num_righe<span style="color:#666">=</span><span style="color:#a2f">len</span>(M)
 num_colonne<span style="color:#666">=</span><span style="color:#a2f">len</span>(M[<span style="color:#666">0</span>])
 <span style="color:#a2f;font-weight:bold">return</span> (num_righe,num_colonne)

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">MinAij</span>(M,s):
 num_righe, num_colonne<span style="color:#666">=</span>dims(M)
 ijmin<span style="color:#666">=</span>[s,s]
 valmin<span style="color:#666">=</span><span style="color:#a2f">max</span>( <span style="color:#a2f">max</span>([<span style="color:#a2f">abs</span>(x) <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> M[j][s:]]) <span style="color:#a2f;font-weight:bold">for</span> j <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s,num_righe) )
 <span style="color:#a2f;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> (<span style="color:#a2f">range</span>(s,num_righe)):
  <span style="color:#a2f;font-weight:bold">for</span> j <span style="color:#a2f;font-weight:bold">in</span> (<span style="color:#a2f">range</span>(s,num_colonne)):
   <span style="color:#a2f;font-weight:bold">if</span> (M[i][j] <span style="color:#666">!=</span> <span style="color:#666">0</span> ) <span style="color:#a2f;font-weight:bold">and</span> (<span style="color:#a2f">abs</span>(M[i][j]) <span style="color:#666">&lt;</span><span style="color:#666">=</span> valmin) :
    ijmin <span style="color:#666">=</span> [i,j]
    valmin <span style="color:#666">=</span> <span style="color:#a2f">abs</span>(M[i][j])
 <span style="color:#a2f;font-weight:bold">return</span> ijmin

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">IdentityMatrix</span>(n):
 res<span style="color:#666">=</span>[[<span style="color:#666">0</span> <span style="color:#a2f;font-weight:bold">for</span> j <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(n)] <span style="color:#a2f;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(n)]
 <span style="color:#a2f;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(n):
  res[i][i] <span style="color:#666">=</span> <span style="color:#666">1</span>
 <span style="color:#a2f;font-weight:bold">return</span> res

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">display</span>(M):
 r<span style="color:#666">=</span><span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b44">&#34;</span>
 <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> M:
  r <span style="color:#666">+</span><span style="color:#666">=</span> <span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b68;font-weight:bold">%s</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#b44">&#34;</span> <span style="color:#666">%</span> x
 <span style="color:#a2f;font-weight:bold">return</span> r <span style="color:#666">+</span><span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b44">&#34;</span>
</code></pre></div><p>Then, one needs the elementary operations on rows and columns on the matrix $M$:
swap (permute) two rows, add to a row an integer multiple of another row, and
change sign of a row. The same for columns.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">swap_rows</span>(M,i,j):
 tmp<span style="color:#666">=</span>M[i]
 M[i]<span style="color:#666">=</span>M[j]
 M[j]<span style="color:#666">=</span>tmp

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">swap_columns</span>(M,i,j):
 num_of_columns<span style="color:#666">=</span><span style="color:#a2f">len</span>(M)
 <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(num_of_columns):
  tmp<span style="color:#666">=</span>M[x][i]
  M[x][i] <span style="color:#666">=</span> M[x][j]
  M[x][j] <span style="color:#666">=</span> tmp

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">add_to_row</span>(M,x,k,s):
 num_righe,num_colonne<span style="color:#666">=</span>dims(M)
 <span style="color:#a2f;font-weight:bold">for</span> tmpj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(num_colonne):
  M[x][tmpj] <span style="color:#666">+</span><span style="color:#666">=</span> k <span style="color:#666">*</span> M[s][tmpj]

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">add_to_column</span>(M,x,k,s):
 num_righe,num_colonne<span style="color:#666">=</span>dims(M)
 <span style="color:#a2f;font-weight:bold">for</span> tmpj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(num_righe):
  M[tmpj][x] <span style="color:#666">+</span><span style="color:#666">=</span> k <span style="color:#666">*</span> M[tmpj][s]

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">change_sign_row</span>(M,x):
 num_righe,num_colonne<span style="color:#666">=</span>dims(M)
 <span style="color:#a2f;font-weight:bold">for</span> tmpj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(num_colonne):
  M[x][tmpj] <span style="color:#666">=</span> <span style="color:#666">-</span> M[x][tmpj]

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">change_sign_column</span>(M,x):
 num_righe,num_colonne<span style="color:#666">=</span>dims(M)
 <span style="color:#a2f;font-weight:bold">for</span> tmpj <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(num_righe):
  M[tmpj][x] <span style="color:#666">=</span> <span style="color:#666">-</span> M[tmpj][x]
</code></pre></div><p>Finally, two important functions. The first,  checks that the entry at place $(s,s)$ in the matrix $M$
is the only one non-zero in its $s$-th column under $s$ and $s$-th row at the right of $s$. If this is true,
then the algorithm will proceed.</p>
<p>The second, will scan in the submatrix at the lower-right of $M_ {s,s}$, to check if there is any entry which
is not divisible by $M_ {s,s}$. If it cannot be found, then it returns an empty set.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">is_lone</span>(M,s):
 num_righe,num_colonne<span style="color:#666">=</span>dims(M)
 <span style="color:#a2f;font-weight:bold">if</span> [M[s][x] <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s<span style="color:#666">+</span><span style="color:#666">1</span>,num_colonne) <span style="color:#a2f;font-weight:bold">if</span> M[s][x] <span style="color:#666">!=</span> <span style="color:#666">0</span>] <span style="color:#666">+</span> [ M[y][s] <span style="color:#a2f;font-weight:bold">for</span> y <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s<span style="color:#666">+</span><span style="color:#666">1</span>,num_righe) <span style="color:#a2f;font-weight:bold">if</span> M[y][s] <span style="color:#666">!=</span> <span style="color:#666">0</span>] <span style="color:#666">==</span> []:
  <span style="color:#a2f;font-weight:bold">return</span> True
 <span style="color:#a2f;font-weight:bold">else</span>:
  <span style="color:#a2f;font-weight:bold">return</span> False

<span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">get_nextentry</span>(M,s):
  <span style="color:#080;font-style:italic"># find and element which is not divisible by M[s][s]</span>
  num_righe,num_colonne<span style="color:#666">=</span>dims(M)
  <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s<span style="color:#666">+</span><span style="color:#666">1</span>,num_righe):
   <span style="color:#a2f;font-weight:bold">for</span> y <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s<span style="color:#666">+</span><span style="color:#666">1</span>,num_colonne):
    <span style="color:#a2f;font-weight:bold">if</span> M[x][y] <span style="color:#666">%</span> M[s][s]  <span style="color:#666">!=</span> <span style="color:#666">0</span>:
     <span style="color:#a2f;font-weight:bold">return</span> (x,y)
  <span style="color:#a2f;font-weight:bold">return</span> None
</code></pre></div><p>Given all these functions, the algorithm/proof is rather simple, as written in the folliwing block.
The main idea is to put at the UL corner $M_ {0,0}$ the GCD of all matrix entries,
by row/column operations.</p>
<p>First, find the smallest non-zero entry, and put it in the UL corner.
Then, as in the Euclidean Algorithm, sum to all rows and columns suitable multiples of the first
row/column.
After this, either
all the elements in the $0$-th row and $0$-th column are zero except $M_ {0,0}$, or not.
If all the elements in the $0$-th row and $0$-th column V
except $M_ {0,0}$  are zero,
then either $M_ {0,0}$ divides all the entries of $M$,
or not.</p>
<p><strong>If it does divide all</strong>,
then proceed to the submatrix obtained by deleting the first row and the first column.
It is important to note that since $M_ {0,0}$ divides all the entries of $M$,
it will divide all the entries of the submatrix and also all the entries of
the subsequente modifications of the submatrix. Hence, when at the end the matrix will be
in diagonal form, the first term $M_ {0,0}$ will divide all the others.</p>
<p><strong>If it does not divide all</strong>, then add to the first row the row containing the entry which is not
divisible by $M_ {0,0}$.
So, the new matrix is of the type with $M_ {0,0}$ at the UL corner, and
not all the elements in the $0$-th row and $0$-th column
except $M_ {0,0}$  are zero.</p>
<p>Now go back  to the step of finding the new non-zero minimum, put it in $(0,0)$,  and repeat from there.</p>
<p>Why in a finite number of steps $M_ {0,0}$ has to divide all the entries?
At the UL corner, $M_ {0,0}$ was chosen to be the minimum of non-zero terms
of $M$, and the new one will be $M&rsquo;_ {0,0} \leq M_ {0,0}$. But, if there was an entry<br>
not divisible by $M_ {0,0}$, then $M&rsquo;_ {0,0} &lt; M_ {0,0}$.
We show this with an example.
Assume $a$ does not divide $b$ (and hence $a\neq b$),
both positive. First, add the second row to the first.
$$
\begin{bmatrix}
a &amp; 0 \\\<br>
0 &amp; b
\end{bmatrix}
\mapsto
\begin{bmatrix}
a &amp; b \\\<br>
0 &amp; b
\end{bmatrix}
$$
Then, there are two cases: either $a &lt; b$, and we do nothing,  or $a &gt; b$,
and we permute the two columns.
$$
\mapsto
\begin{cases}
\begin{bmatrix}
a &amp; b \\\<br>
0 &amp; b
\end{bmatrix}
&amp; \text{if $a&lt;b$}
\\\<br>
\begin{bmatrix}
b &amp; a \\\<br>
b &amp; 0
\end{bmatrix}
&amp; \text{if $b &lt; a$}
\end{cases}
$$
After this, it is time to add suitable multiples. In the two cases,
it happens (adding forst rows, then columns) the following.
$$
\mapsto
\begin{cases}
\begin{bmatrix}
a &amp; b-qa \\\<br>
0 &amp; b
\end{bmatrix}
&amp; \text{if $a&lt;b$}
\\\<br>
\begin{bmatrix}
b &amp; a-qb \\\<br>
0 &amp; -a
\end{bmatrix}
&amp; \text{if $b &lt; a$}
\end{cases}
$$
If $a&lt;b$, it is $|b-qa|&lt;a$.
If $b&lt;a$, it is $|a-qb| &lt; b &lt; a$.
Hence in both cases after the row/column operations, the minimum of the matrix entries
will be strictly smaller than $a$. Since this cannot happen indefinitively, after a finite
number of steps $M_ {0,0}$ will divide all the remaining entries in $M$.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a2f;font-weight:bold">def</span> <span style="color:#00a000">Smith</span>(M):
 num_righe,num_colonne<span style="color:#666">=</span>dims(M)
 L <span style="color:#666">=</span> IdentityMatrix(num_righe)
 R <span style="color:#666">=</span> IdentityMatrix(num_colonne)
 maxs<span style="color:#666">=</span><span style="color:#a2f">min</span>(num_righe,num_colonne)
 <span style="color:#a2f;font-weight:bold">for</span> s <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(maxs):
  <span style="color:#a2f;font-weight:bold">print</span> (<span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b44">step </span><span style="color:#b68;font-weight:bold">%s</span><span style="color:#b44">/</span><span style="color:#b68;font-weight:bold">%s</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#b44">&#34;</span> <span style="color:#666">%</span> (s<span style="color:#666">+</span><span style="color:#666">1</span>,maxs))
  <span style="color:#a2f;font-weight:bold">print</span> <span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b44">M:</span><span style="color:#b44">&#34;</span>, display(M)
  <span style="color:#a2f;font-weight:bold">while</span> <span style="color:#a2f;font-weight:bold">not</span> is_lone(M,s):
   i,j <span style="color:#666">=</span> MinAij(M,s) <span style="color:#080;font-style:italic"># the non-zero entry with min |.|</span>
   swap_rows(M,s,i)
   swap_rows(L,s,i)
   swap_columns(M,s,j)
   swap_columns(R,s,j)
   <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s<span style="color:#666">+</span><span style="color:#666">1</span>,num_righe):
    <span style="color:#a2f;font-weight:bold">if</span> M[x][s] <span style="color:#666">!=</span> <span style="color:#666">0</span>:
     k <span style="color:#666">=</span> M[x][s] <span style="color:#666">/</span><span style="color:#666">/</span> M[s][s]
     add_to_row(M,x,<span style="color:#666">-</span>k,s)
     add_to_row(L,x,<span style="color:#666">-</span>k,s)
   <span style="color:#a2f;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#a2f">range</span>(s<span style="color:#666">+</span><span style="color:#666">1</span>,num_colonne):
    <span style="color:#a2f;font-weight:bold">if</span> M[s][x] <span style="color:#666">!=</span> <span style="color:#666">0</span>:
     k <span style="color:#666">=</span> M[s][x] <span style="color:#666">/</span><span style="color:#666">/</span> M[s][s]
     add_to_column(M,x,<span style="color:#666">-</span>k,s)
     add_to_column(R,x,<span style="color:#666">-</span>k,s)
   <span style="color:#a2f;font-weight:bold">if</span> is_lone(M,s):
    res<span style="color:#666">=</span>get_nextentry(M,s)
    <span style="color:#a2f;font-weight:bold">if</span> res:
     x,y<span style="color:#666">=</span>res
     add_to_row(M,s,<span style="color:#666">1</span>,x)
     add_to_row(L,s,<span style="color:#666">1</span>,x)
    <span style="color:#a2f;font-weight:bold">else</span>:
     <span style="color:#a2f;font-weight:bold">if</span> M[s][s]<span style="color:#666">&lt;</span><span style="color:#666">0</span>:
      change_sign_row(M,s)
      change_sign_row(L,s)
 <span style="color:#a2f;font-weight:bold">return</span> L,R
</code></pre></div><p>A minor step is the one for changing sign of the diagonal entry, just in the case it is negative. At the end, the matrix $M$ will be in
Smith Normal Form,
and the routine will return the two unimodular matrices $L$ and $R$ resulting from the row/columns operations respectively.
They are obtained by applying the same row/column operations on two identity matrices.</p>
<h2 id="example-the-triangulated-sphere">Example: the triangulated sphere.</h2>
<p>As an example, here we compute the Smith Normal Forms of the differentials of che chain complex of the triangulate $2$-sphere,
from <a href="http://www.sagemath.org">sage</a>. First, the differential $\partial_ 1 \from C_ 1 \cong \ZZ^6 \to C_ 0 \cong \ZZ^4 $.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sage: K<span style="color:#666">=</span>simplicial_complexes<span style="color:#666">.</span>Sphere(<span style="color:#666">2</span>)
sage: CK<span style="color:#666">=</span>K<span style="color:#666">.</span>chain_complex()
sage: 
sage: M<span style="color:#666">=</span>matrix(ZZ,CK<span style="color:#666">.</span>differential(<span style="color:#666">1</span>))<span style="color:#666">.</span>numpy()<span style="color:#666">.</span>tolist()
sage: Smith(M)
step <span style="color:#666">1</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>]

step <span style="color:#666">2</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]

step <span style="color:#666">3</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]

step <span style="color:#666">4</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]

([[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>], [<span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>], [<span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>], [<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>]],
 [[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>],
  [<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>],
  [<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>],
  [<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>],
  [<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>],
  [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]])
sage: <span style="color:#a2f;font-weight:bold">print</span> <span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#b44">smith form of d_1:</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#b44">&#34;</span>, display(M)

smith form of d_1:
[<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
</code></pre></div><p>Hence $\operatorname{coker} \partial_ 1 \cong  \ZZ^1$ and $\ker \partial_ 1 \cong  \ZZ^3$.
What about the generators of $\ker \partial_ 1$?
Let $L$ and $R$ denote the left and right matrices, and $M$ the matrix of $\partial_ 1$.
Then let $S$ denote the Smith Normal Form of $\partial_ 1$, so that
$LMR = S$.
Since $\ker S$ is generated by the three vectors
$$
\begin{bmatrix}
0\\\<br>
0\\\<br>
0\\\<br>
1\\\<br>
0\\\<br>
0
\end{bmatrix}
\begin{bmatrix}
0\\\<br>
0\\\<br>
0\\\<br>
0\\\<br>
1\\\<br>
0
\end{bmatrix}
\begin{bmatrix}
0\\\<br>
0\\\<br>
0\\\<br>
0\\\<br>
0\\\<br>
1
\end{bmatrix},
$$
then $\ker LM = \ker M$ is generated by their images by $R$, i.e.
the last three columns of $R$:
$$
\begin{bmatrix}
1\\\<br>
-1\\\<br>
0\\\<br>
1\\\<br>
0\\\<br>
0
\end{bmatrix}
\begin{bmatrix}
1\\\<br>
-1\\\<br>
0\\\<br>
0\\\<br>
1\\\<br>
-1
\end{bmatrix}
\begin{bmatrix}
0\\\<br>
-1\\\<br>
1\\\<br>
0\\\<br>
0\\\<br>
-1
\end{bmatrix},
$$
These three cycles are, in the standard basis of $1$-simplices of $K$
$[(0, 1), (0, 2), (0, 3), (1, 2), (1, 3), (2, 3)]$:
$$
[01]+[20]+[12] = [01] + [12] + [20]~,
$$
$$
[01]+[20]+[13]+[32] = [01] + [13] + [32] + [21]~,
$$
$$
[20] + [03] + [32]~.
$$</p>
<p>Furthermore, about the differential $\partial_ 2$ from $C_ 2 \cong \ZZ^4 \to C_ 1 \cong \ZZ^6 $.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sage: M<span style="color:#666">=</span>matrix(ZZ,CK<span style="color:#666">.</span>differential(<span style="color:#666">2</span>))<span style="color:#666">.</span>numpy()<span style="color:#666">.</span>tolist()
sage: Smith(M)
step <span style="color:#666">1</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>]

step <span style="color:#666">2</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>]

step <span style="color:#666">3</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>]

step <span style="color:#666">4</span><span style="color:#666">/</span><span style="color:#666">4</span>

M: [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]

([[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>],
  [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>],
  [<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>],
  [<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>],
  [<span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>],
  [<span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]],
 [[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1</span>], [<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">-</span><span style="color:#666">1</span>], [<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>], [<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">-</span><span style="color:#666">1</span>]])
sage: <span style="color:#a2f;font-weight:bold">print</span> <span style="color:#b44"></span><span style="color:#b44">&#34;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#b44">smith form of d_2:</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#b44">&#34;</span>, display(M)

smith form of d_2:
[<span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">1</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
[<span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>, <span style="color:#666">0</span>]
</code></pre></div><p>Therefore, $\ker \partial_ 2 \cong \ZZ$, and $\operatorname{coker} \partial_ 2 \cong \ZZ^3$.
The generator of $\ker \partial_ 2$ is, as above, the last column of $R$,
which is
$$
\begin{bmatrix}
1\\\<br>
-1\\\<br>
1\\\<br>
-1\\\<br>
\end{bmatrix}
$$
which corresponds to the cycle
in the standard basis $ [ (0, 1, 2), (0, 1, 3), (0, 2, 3), (1, 2, 3) ] $
$$
[ 012 ] - [ 013 ] + [ 023 ] - [ 123 ] = - ( [ 123 ] - [ 023 ] + [ 013 ] - [ 012 ] ) =
$$
$$
= - \sum_ {j=0}^3 (-1)^j [ 0 \ldots \hat j \ldots 3 ]~.
$$</p>
<p>Is it possible to compute the homology with these data?</p>
<h2 id="computing-homology-groups">Computing homology groups</h2>
<p>Now, consider just $H_ 1(K) = \ker \partial_ 1 / \operatorname{Im} \partial_ 2$.
Let $Z_ 1 = \ker \partial_ 1$ and $B_ 1 = \operatorname{Im} \partial_ 2$.
Let $S_ 1$ and $S_ 2$ the SNF&rsquo;s of $ \partial_ 1 $ and  $ \partial_ 2 $,
and $L_ 1$ , $L_ 2$, $R_ 1$ and $R_ 2$ the unimodular matrices of row/columns operations.
Then $L_ 1 \partial_ 1 R_ 1 = S_ 1$ and $L_ 2 \partial_ 2 R_ 2 = S_ 2$,
as in the following diagram.</p>
<center>
![Chain complex diagram](/img/c2c1.svg)
</center>
<p>Let $\alpha_ 1$, $\alpha_ 2$, $\ldots$, $\alpha_ q$
be the *elementary divisors* of $\partial_ 2$, i.e.
the non-zero diagonal terms of $S_ 2$,
and $\beta_ 1$, $\beta_ 2$, $\ldots$, $\beta_ r$
the *elementary divisors* of $\partial_ 1$, i.e.
the non-zero diagonal terms of $S_ 1$.
Let $\ve_ 1$, $\ve_ 2$, $\ldots$, $\ve_ {c_ 1}$ be
the standard basis of $\ZZ^{c_ 1}$.</p>
<p>Since $\ker S_ 1$ is generated by the
$c_ 1 - r$ elements $\ve_ {r+1}$, $\ldots$,
$\ve_ {c_ 1}$,
as show above, $Z_ 1$ is freely generated by the last $c_ 1 - r$ columns of $R_ 1$.</p>
<p>On the other hand,
$\operatorname{Im} S_ 2$ is freely generated by
$$
\alpha_ 1 \ve_ 1, \alpha_ 2 \ve_ 2, \ldots, \alpha_ q \ve_ q
$$
hence
$B_ 1\subset Z_ 1 \subset C_ 1$ is freely generated by
$\alpha_ j$-multiples of the first $q$ columns of the inverse $L_ 2^{-1}$.
Now, $C_ 1 = Q \oplus Q'$,
where $Q$ is the subgroup generated by the first $q$ columns of $L_ 2^{-1}$,
and $Q'$ the subgroup generated by the last $c_ 1 - q$ columns of $L_ 2^{-1}$.</p>
<p>By construction $B_ 1 \subset Q$, and since $C_ 1$ is torsion-free, $Q\subset Z_ 1$.
Now, define
$Q&rsquo;&rsquo; = Q&rsquo; \cap Z_ 1$, which is a subgroup of $Z_ 1$.  Since $Q&rsquo;&rsquo; \cap Q = 0$,
it is defined the direct sum
$Q\oplus Q&rsquo;&rsquo; \subset Z_ 1$. If $x \in Z_ 1 \subset C_ 1 = Q \oplus Q'$, then
$x=q + q'$ with $q \in Q$ and $q&rsquo; \in Q'$,
and $0 = \partial_ 1 x = \partial_ 1 q + \partial_ 1 q&rsquo; = \partial_ 1 q'$,
hence $x=q + q'$ with $q \in Q$ and $q&rsquo; \in Q&rsquo; \cap Z_ 1 = Q'&lsquo;$,
and hence $Z_ 1 = Q \oplus Q'&lsquo;$.</p>
<p>Since $Z_ 1=Q\oplus Q'&lsquo;$ is a free abelian group of rank $c_ 1 - r$,
and  $Q$ is a free abelian subgroup of rank $q$,</p>
<dl>
<dt>(1)</dt>
<dd>$Q&rsquo;'\subset Z_ 1$ is a free abelian group of rank $c_ 1 - r - q$.</dd>
</dl>
<p>Furthermore, since $B_ 1 \subset Q$,  the quotient $Z_ 1 / B_ 1$ splits as
$$
\dfrac{Z_ 1 }{ B_ 1  } =
\dfrac{Q \oplus  Q&rsquo;'}{ B_ 1\oplus 0}
\cong
\dfrac{Q}{ B_ 1 } \oplus Q&rsquo;&rsquo;<br>
\cong
$$
$$
\cong \ZZ_ {\alpha_ 1} \oplus  \ldots \oplus
\ZZ_ {\alpha_ q} \oplus
\ZZ^{c_ 1 - r - q},
$$
where $\ZZ_ \alpha$ denotes the cyclic group
$\ZZ / \alpha \ZZ$ of order $\alpha$.</p>
<dl>
<dt>(2)</dt>
<dd>The homology group $H_ j$ is isomorphic to
$ \ZZ_ {\alpha_ 1} \oplus  \ldots \oplus
\ZZ_ {\alpha_ q} \oplus
\ZZ^{c_ j - r - q}$,
where $\alpha_ 1$, $\ldots,$ $\alpha_ q$ are the elementary divisors of $S_ {j+1}$,
$c_ j$ the rank of $C_ j$,
and $r$ the number of elementary divisors of $S_ j$.</dd>
</dl>
<p>So, for the chain complex of the sphere:
$c_ 2 = 4$, $c_ 1 = 6$, $c_ 0 = 4$;
from $S_ 1$:
$\beta_ 1 = \beta_ 2 = \beta_ 3 = 1$,
$r= 3$;
from $S_ 2$:
$\alpha_ 1 = \alpha_ 2 = \alpha_ 3= 1$,
$q=3$.</p>
<p>Hence, for the sphere,
$$
\begin{aligned}
H_ 0 &amp;  \cong \ZZ_ 1 \oplus \ZZ_ 1 \oplus \ZZ_ 1 \oplus \ZZ^{4-0-3} = \ZZ \\\
H_ 1 &amp; \cong \ZZ_ 1 \oplus \ZZ_ 1 \oplus \ZZ_ 1 \oplus \ZZ^{6-3-3} = 0 \\\<br>
H_ 2 &amp; \cong \ZZ^{4-0-3} = \ZZ .
\end{aligned}
$$</p>
<p><strong>Remark:</strong> We did not compute explicit isomorphisms of $H_ j \cong Z_ j / B_ j$.
In fact, we even did not compute the inverse $L_ j^{-1}$. To have an explicit presentation
(generators  and relations) of $H_ j$ one needs to proceed as follows.</p>
<p>First, generators of $\ker S_ 1$ in $\ZZ^{c_ 1}$ are $\ve_ {q+1}$, $\ldots,$ $\ve_ {c_ 1}$.
Next, generators of $R_ 1^{-1}Q$ are $\vw_ j = R_ 1^{-1} L_ 2^{-1} \ve_ j$ for $j=1,\ldots, q$.
Since for each $j=1,\ldots, q$, $L_ 2^{-1} \ve_ j \in Q$, hence
$$ S_ 1 \vw_ j = S_ 1 R_ 1^{-1} L_ 2^{-1} \ve_ j = L_ 1 \partial_ 1 L_ 2^{-1} \ve_ j = 0, $$
which means that the first $r$ entries of $\vw_ j$ are zero.
Note that the projection  $p\from Z_ 1 = Q\oplus Q&rsquo;&rsquo; \to Q $,
after $R_ 1^{-1}$, is a projection
$ \ZZ^{c_ 1 - r}  \to \ZZ^{q}$. Its kernel is $Q'&lsquo;$.</p>
<p>So, let $T$ denote the $(c_ 1 -r ) \times q$ matrix
whose $q$ columns are the last $c_ 1 - r$ entries of $\vw_ j$,
for $j=1,\ldots, q$. It represents the monomorphism
$T\from R_ 1^{-1} Q \to \ker S_ 1$, or
$T \from  \ZZ^q \to \ZZ^{c_ 1 - r}.$
Let $S_ T$ its Smith Normal Form, and $L_ T$ and $R_ T$ the unimodular matrices
such that $S_ T = L_ T T R_ T$.
By the arguments above, $S_ T $ has $q$ $1$'s as elementary divisors,
and the rest are $0$.
Furthermore, the unimodular matrix
$L_ T ^{-1} \from \ZZ^{c_ 1 - r} \to \ZZ^{c_ 1 - r}$<br>
sends the first $q$ elements of the standard basis $\ve_ j$, $j=1,\ldots, q$,
to a set of generators for $Q$ (the image of $T$ in $\ker S_ 1$).
The latter $c_ 1 - r - q$ columns of $L_ T^{-1}$ are the coefficients
of a set of generators of $Q'&lsquo;$ in the standard basis of $\ker S_ 1$,
which we can denote by $\vw_ {q+1}, \ldots, \vw_ {c_ 1 - r}$ (by adding
$q$ zeros at the head of the $(c_ 1 - r)$-tuple).</p>
<p>So, going back to $C_ 1$, $Z_ 1$ is generated by
the elements of $Q$, i.e.
$$ R_ 1 \vw_ 1 = L_ 2^{-1} \ve_ 1, \ldots R_ 1 \vw_ q = L_ 2^{-1} \ve_ q, $$
and the elements of  \( Q&rsquo;&rsquo; \),
i.e.<br>
$$
R_ 1 \vw_ {q+1} =  R_ 1 L_ T^{-1} \ve_ {q+1} \ldots R_ 1 \vw_ {c_ 1 - r} =  R_ 1 L_ T^{-1} \ve_ {c_ 1 - r}
$$
where suitable zeros are added when necessary.
More in <a href="http://link.springer.com/book/10.1007%2Fb97315">Computational Homology</a>,
by *Tomasz Kaczynski, Konstantin Mischaikow, Marian Mrozek*, Springer, 2004.</p>

</div>

     </div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<footer class="site-footer">
    <div class="container">
        <p class="powered-by">
            Copyright © 2016 - 3016, DL Ferrario &middot; 
	    <a href="//www.dlfer.xyz/p/privacy/">Privacy</a> &middot;
            Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>.
            <span class="pull-right"><a href="#" id="back_to_top"><span class="button_icon"><i class="fa fa-chevron-up fa-2x" aria-hidden="true"></i></span></a></span>
        </p>
    </div>
</footer>
    
  
        
        
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { 
                                          inlineMath: [['$','$'], ['\\(','\\)']], 
				          displayMath: [['$$','$$'], ['\\[','\\]']],
				          processEscapes: true,
				          processEnvironments: true,
				          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				          TeX: { equationNumbers: { autoNumber: "AMS" },
				          extensions: ["AMSmath.js", "AMSsymbols.js","AMScd.js"] }
                                           } 
                                });
        </script>
        <script async src="//www.dlfer.xyz//MJ/MathJax.js?config=TeX-AMS_CHTML,local/local.js"></script>
        
  
 
</body>
</html>

